<!doctype html><html><head><meta charset='utf-8'><title>checkMultiLog日志安全分析报告</title><style>
:root{--bg:#fff;--fg:#222;--muted:#666;--card:#f6f8fa;--line:#e6e6e6;--hit:#fff8e1;}
html[data-theme=dark]{--bg:#111;--fg:#eee;--muted:#aaa;--card:#1b1b1b;--line:#333;--hit:#222814;}
body{font-family:Segoe UI,Arial; margin:0; background:var(--bg); color:var(--fg);}
header{position:sticky; top:0; background:var(--card); border-bottom:1px solid var(--line); padding:10px 16px; z-index:10;}
main{padding:16px;}
h1{font-size:18px; margin:0 0 6px 0;}
.meta{font-size:12px; color:var(--muted);} .bar{display:flex; gap:12px; align-items:center; flex-wrap:wrap; margin-top:8px;}
input[type=text]{padding:6px 10px; width:360px; background:var(--bg); color:var(--fg); border:1px solid var(--line);}
button{padding:6px 10px; border:1px solid var(--line); background:var(--bg); color:var(--fg); cursor:pointer;}
section{margin-top:18px;} table{border-collapse:collapse; width:100%;}
th,td{border:1px solid var(--line); padding:6px 8px; font-size:13px; vertical-align:top;} th{background:#f5f5f5; text-align:left;}
details{border:1px solid var(--line); margin:8px 0; background:var(--card);} details>summary{padding:8px; cursor:pointer; font-weight:600; background:#f5f5f5;}
.evt-row{background:var(--hit);} code{font-size:11px;} .muted{color:var(--muted);} a{color:inherit; text-decoration:underline;}
.iplink{cursor:pointer; color:#2a7ae2; text-decoration:underline;} .pill{display:inline-block; padding:2px 8px; border:1px solid var(--line); border-radius:10px; margin:0 6px 0 0; font-size:12px;}
.wh-box{display:flex; gap:8px; flex-wrap:wrap; align-items:center;}
</style><script>
const whitelist = {ips:new Set(), ua:[], path:[], rule:[]};
function filterRows(){
  const q=document.getElementById('q').value.toLowerCase();
  const rows=[...document.querySelectorAll('.evt-row')];
  rows.forEach(tr=>{
    const txt=tr.innerText.toLowerCase();
    const ip=tr.dataset.ip || ''; const ua=tr.dataset.ua || ''; const path=tr.dataset.path || ''; const rule=tr.dataset.rule || '';
    let ok = (!q || txt.includes(q));
    if(ok){
      if(whitelist.ips.size && whitelist.ips.has(ip)) ok=false;
      if(ok && whitelist.ua.length){ ok = !whitelist.ua.some(p=>new RegExp(p,'i').test(ua)); }
      if(ok && whitelist.path.length){ ok = !whitelist.path.some(p=>new RegExp(p,'i').test(path)); }
      if(ok && whitelist.rule.length){ ok = !whitelist.rule.some(p=>new RegExp(p,'i').test(rule)); }
    }
    tr.style.display = ok ? '' : 'none';
  });
  const ipCount=new Map(), ruleCount=new Map();
  document.querySelectorAll('.evt-row[data-ip]').forEach(tr=>{
    if(tr.style.display==='none') return;
    const ip=tr.dataset.ip, rule=tr.dataset.rule;
    ipCount.set(ip, (ipCount.get(ip)||0)+1);
    ruleCount.set(rule, (ruleCount.get(rule)||0)+1);
  });
  const ipBody=document.getElementById('top_ips_body'); if(ipBody){ ipBody.innerHTML=''; let i=1; [...ipCount.entries()].sort((a,b)=>b[1]-a[1]).slice(0,80).forEach(([ip,cnt])=>{
    const safe=ip.replace(/[^a-zA-Z0-9_.-]/g,'_'); const tr=document.createElement('tr'); tr.innerHTML=`<td>${i++}</td><td><a class="iplink" onclick="openIp('${safe}')">${ip}</a></td><td>${cnt}</td>`; ipBody.appendChild(tr);
  });}
  const ruleBody=document.getElementById('top_rules_body'); if(ruleBody){ ruleBody.innerHTML=''; let i=1; [...ruleCount.entries()].sort((a,b)=>b[1]-a[1]).slice(0,80).forEach(([rule,cnt])=>{
    const tr=document.createElement('tr'); tr.innerHTML=`<td>${i++}</td><td>${rule}</td><td>${cnt}</td>`; ruleBody.appendChild(tr);
  });}
}
function initTheme(){ const t=localStorage.getItem('theme')||'light'; document.documentElement.setAttribute('data-theme', t); }
function toggleTheme(){ const cur=document.documentElement.getAttribute('data-theme'); const nxt = cur==='dark'?'light':'dark'; localStorage.setItem('theme',nxt); document.documentElement.setAttribute('data-theme',nxt); }
function openIp(ip){
  const id='ip_'+ip.replace(/[^a-zA-Z0-9_.-]/g,'_'); const el=document.getElementById(id);
  if(el){ el.setAttribute('open','open'); el.scrollIntoView({behavior:'smooth', block:'start'}); }
}
function addWhitelist(type){
  const el = document.getElementById('wh_'+type); const val = (el.value||'').trim(); if(!val) return;
  if(type==='ip'){ whitelist.ips.add(val); addPill(type,val); }
  else { whitelist[type].push(val); addPill(type,val); }
  el.value=''; filterRows();
}
function addPill(type, val){
  const box = document.getElementById('whlist_'+type);
  const span = document.createElement('span'); span.className='pill'; span.textContent=type+': '+val+' ✕';
  span.onclick=()=>{ if(type==='ip'){ whitelist.ips.delete(val);} else { const arr=whitelist[type]; const i=arr.indexOf(val); if(i>=0) arr.splice(i,1);} span.remove(); filterRows(); };
  box.appendChild(span);
}
window.addEventListener('DOMContentLoaded', ()=>{ initTheme(); filterRows(); });
</script></head><body><header><h1>checkMultiLog日志安全分析报告</h1><div class='meta'>Log: <b>D:/sectools/BlueTeamTools/checkMultiLog/checkmultilog日志分析-GUI_V2/simpleLog\aws_alb_access_2025-08-26.log</b> | Total: <b>200</b> | Hits: <b>5</b></div><div class='bar'><input id='q' type='text' placeholder='搜索 关键词' oninput='filterRows()'><button onclick='toggleTheme()'>Light/Dark</button><div class='wh-box'>IP白名单: <input id='wh_ip' type='text' placeholder='192.168.1.1'> <button onclick="addWhitelist('ip')">添加</button>UA白名单(正则): <input id='wh_ua' type='text' placeholder='curl|monitor'> <button onclick="addWhitelist('ua')">添加</button>路径白名单(正则): <input id='wh_path' type='text' placeholder='/health|/metrics'> <button onclick="addWhitelist('path')">添加</button>规则白名单(正则): <input id='wh_rule' type='text' placeholder='SafeScanner|Docker'> <button onclick="addWhitelist('rule')">添加</button></div><div class='wh-box'><div id='whlist_ip'></div><div id='whlist_ua'></div><div id='whlist_path'></div><div id='whlist_rule'></div></div></div></header><main><section><h2>Top Source IPs</h2><table><thead><tr><th>#</th><th>IP</th><th>Hits(过滤后)</th></tr></thead><tbody id='top_ips_body'><tr><td>1</td><td><a class='iplink' onclick="openIp('1.0.193.231')">1.0.193.231</a></td><td>1</td></tr><tr><td>2</td><td><a class='iplink' onclick="openIp('1.144.11.146')">1.144.11.146</a></td><td>1</td></tr><tr><td>3</td><td><a class='iplink' onclick="openIp('172.140.248.60')">172.140.248.60</a></td><td>1</td></tr><tr><td>4</td><td><a class='iplink' onclick="openIp('172.47.107.215')">172.47.107.215</a></td><td>1</td></tr><tr><td>5</td><td><a class='iplink' onclick="openIp('185.105.149.16')">185.105.149.16</a></td><td>1</td></tr></tbody></table></section><section><h2>Top Rules</h2><table><thead><tr><th>#</th><th>Rule</th><th>Hits(过滤后)</th></tr></thead><tbody id='top_rules_body'><tr><td>1</td><td>路径遍历/敏感文件</td><td>2</td></tr><tr><td>2</td><td>WebShell管理命令</td><td>1</td></tr><tr><td>3</td><td>SQL注入(精简高准确)</td><td>1</td></tr><tr><td>4</td><td>SSRF 内网/云元数据访问</td><td>1</td></tr></tbody></table></section><section><h2>Events by IP</h2><details id='ip_1.0.193.231'><summary>1.0.193.231 <span class='muted'>(1 hits)</span></summary><table><thead><tr><th>Time</th><th>Method</th><th>Path</th><th>Status</th><th>Rule</th><th>User-Agent</th></tr></thead><tbody><tr class='evt-row' data-ip='1.0.193.231' data-ua='forward' data-path='https://shop.example.com:443/run?cmd=whoami%3B+cat+%2Fetc%2Fpasswd' data-rule='路径遍历/敏感文件'><td class='muted'></td><td>GET</td><td>https://shop.example.com:443/run?cmd=whoami%3B+cat+%2Fetc%2Fpasswd</td><td>-</td><td>路径遍历/敏感文件</td><td class='muted'>forward</td></tr><tr class='evt-row' data-ip='1.0.193.231' data-ua='forward' data-path='https://shop.example.com:443/run?cmd=whoami%3B+cat+%2Fetc%2Fpasswd' data-rule='路径遍历/敏感文件'><td colspan='6' class='muted'><code>https 2025-08-26T03:00:08.983000Z app/my-alb/50dc6c495c0c9188 1.0.193.231:22990 10.48.14.138:80 0.001117 0.495036 0.001583 302 302 1813 3483 &quot;GET https://shop.example.com:443/run?cmd=whoami%3B+cat+%2Fetc%2Fpasswd HTTP/1.1&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 Chrome/124.0 Safari/537.36&quot; - - arn:aws:elasticloadbalancing:us-west-2:123456789012:targetgroup/my-tg/73e2d6bc24d8a067 &quot;Root=1-5689b4f5-428985a688d3c279c54b2450&quot; shop.example.com arn:aws:acm:us-west-2:123456789012:certificate/abcd1234-5678-90ab-cdef-EXAMPLE -1 2025-08-26T03:00:08.983000Z &quot;forward&quot; - - - - - -
</code></td></tr></tbody></table></details><details id='ip_1.144.11.146'><summary>1.144.11.146 <span class='muted'>(1 hits)</span></summary><table><thead><tr><th>Time</th><th>Method</th><th>Path</th><th>Status</th><th>Rule</th><th>User-Agent</th></tr></thead><tbody><tr class='evt-row' data-ip='1.144.11.146' data-ua='forward' data-path='https://shop.example.com:443/admin/exec?cmd=id%26%26uname+-a' data-rule='WebShell管理命令'><td class='muted'></td><td>POST</td><td>https://shop.example.com:443/admin/exec?cmd=id%26%26uname+-a</td><td>-</td><td>WebShell管理命令</td><td class='muted'>forward</td></tr><tr class='evt-row' data-ip='1.144.11.146' data-ua='forward' data-path='https://shop.example.com:443/admin/exec?cmd=id%26%26uname+-a' data-rule='WebShell管理命令'><td colspan='6' class='muted'><code>https 2025-08-26T03:00:06.932000Z app/my-alb/50dc6c495c0c9188 1.144.11.146:31414 10.33.60.177:9000 0.001599 0.299486 0.011355 400 400 1581 919 &quot;POST https://shop.example.com:443/admin/exec?cmd=id%26%26uname+-a HTTP/1.1&quot; &quot;Mozilla/5.0 (X11; Linux x86_64; rv:126.0) Gecko/20100101 Firefox/126.0&quot; ECDHE-RSA-AES128-GCM-SHA256 - arn:aws:elasticloadbalancing:us-west-2:123456789012:targetgroup/my-tg/73e2d6bc24d8a067 &quot;Root=1-1bdddcb9-17514085731227dc8f79bd1a&quot; shop.example.com arn:aws:acm:us-west-2:123456789012:certificate/abcd1234-5678-90ab-cdef-EXAMPLE 1 2025-08-26T03:00:06.932000Z &quot;forward&quot; - - - - - -
</code></td></tr></tbody></table></details><details id='ip_172.140.248.60'><summary>172.140.248.60 <span class='muted'>(1 hits)</span></summary><table><thead><tr><th>Time</th><th>Method</th><th>Path</th><th>Status</th><th>Rule</th><th>User-Agent</th></tr></thead><tbody><tr class='evt-row' data-ip='172.140.248.60' data-ua='forward' data-path='https://shop.example.com:443/api/xml?data=%3C%3Fxml+version%3D%221.0%22%3F%3E%3C%21DOCTYPE+x+%5B%3C%21ENTITY+d+SYSTEM+%22file%3A%2F%2F%2Fetc%2Fpasswd%22%3E%5D%3E%3Cx%3E%26d%3B%3C%2Fx%3E' data-rule='路径遍历/敏感文件'><td class='muted'></td><td>GET</td><td>https://shop.example.com:443/api/xml?data=%3C%3Fxml+version%3D%221.0%22%3F%3E%3C%21DOCTYPE+x+%5B%3C%21ENTITY+d+SYSTEM+%22file%3A%2F%2F%2Fetc%2Fpasswd%22%3E%5D%3E%3Cx%3E%26d%3B%3C%2Fx%3E</td><td>-</td><td>路径遍历/敏感文件</td><td class='muted'>forward</td></tr><tr class='evt-row' data-ip='172.140.248.60' data-ua='forward' data-path='https://shop.example.com:443/api/xml?data=%3C%3Fxml+version%3D%221.0%22%3F%3E%3C%21DOCTYPE+x+%5B%3C%21ENTITY+d+SYSTEM+%22file%3A%2F%2F%2Fetc%2Fpasswd%22%3E%5D%3E%3Cx%3E%26d%3B%3C%2Fx%3E' data-rule='路径遍历/敏感文件'><td colspan='6' class='muted'><code>https 2025-08-26T03:00:17.551000Z app/my-alb/50dc6c495c0c9188 172.140.248.60:57510 10.186.177.148:9000 0.006707 0.473889 0.009168 500 500 1885 1006 &quot;GET https://shop.example.com:443/api/xml?data=%3C%3Fxml+version%3D%221.0%22%3F%3E%3C%21DOCTYPE+x+%5B%3C%21ENTITY+d+SYSTEM+%22file%3A%2F%2F%2Fetc%2Fpasswd%22%3E%5D%3E%3Cx%3E%26d%3B%3C%2Fx%3E HTTP/1.1&quot; &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 13_6) AppleWebKit/605.1.15 Version/17.4 Safari/605.1.15&quot; ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2 arn:aws:elasticloadbalancing:us-west-2:123456789012:targetgroup/my-tg/73e2d6bc24d8a067 &quot;Root=1-40049ce1-aec52f354cb0344715f6aec3&quot; shop.example.com arn:aws:acm:us-west-2:123456789012:certificate/abcd1234-5678-90ab-cdef-EXAMPLE 1 2025-08-26T03:00:17.551000Z &quot;forward&quot; - - - - - -
</code></td></tr></tbody></table></details><details id='ip_172.47.107.215'><summary>172.47.107.215 <span class='muted'>(1 hits)</span></summary><table><thead><tr><th>Time</th><th>Method</th><th>Path</th><th>Status</th><th>Rule</th><th>User-Agent</th></tr></thead><tbody><tr class='evt-row' data-ip='172.47.107.215' data-ua='forward' data-path='http://shop.example.com:80/item?id=1%20UNION%20SELECT%201,@@version,user()' data-rule='SQL注入(精简高准确)'><td class='muted'></td><td>GET</td><td>http://shop.example.com:80/item?id=1%20UNION%20SELECT%201,@@version,user()</td><td>-</td><td>SQL注入(精简高准确)</td><td class='muted'>forward</td></tr><tr class='evt-row' data-ip='172.47.107.215' data-ua='forward' data-path='http://shop.example.com:80/item?id=1%20UNION%20SELECT%201,@@version,user()' data-rule='SQL注入(精简高准确)'><td colspan='6' class='muted'><code>http 2025-08-26T03:00:03.091000Z app/my-alb/50dc6c495c0c9188 172.47.107.215:62122 10.61.225.67:8443 0.002194 0.372714 0.012847 400 400 1701 535 &quot;GET http://shop.example.com:80/item?id=1%20UNION%20SELECT%201,@@version,user() HTTP/1.1&quot; &quot;Mozilla/5.0 (X11; Linux x86_64; rv:126.0) Gecko/20100101 Firefox/126.0&quot; - - arn:aws:elasticloadbalancing:us-west-2:123456789012:targetgroup/my-tg/73e2d6bc24d8a067 &quot;Root=1-77dbb62e-1ead9476cdc7697c0491d02c&quot; shop.example.com - 2 2025-08-26T03:00:03.091000Z &quot;forward&quot; - - - - - -
</code></td></tr></tbody></table></details><details id='ip_185.105.149.16'><summary>185.105.149.16 <span class='muted'>(1 hits)</span></summary><table><thead><tr><th>Time</th><th>Method</th><th>Path</th><th>Status</th><th>Rule</th><th>User-Agent</th></tr></thead><tbody><tr class='evt-row' data-ip='185.105.149.16' data-ua='waf,forward' data-path='http://shop.example.com:80/api/xml?data=%3C%3Fxml+version%3D%221.0%22%3F%3E%3C%21DOCTYPE+x+%5B%3C%21ENTITY+a+SYSTEM+%22http%3A%2F%2F169.254.169.254%2Flatest%2Fmeta-data%2F%22%3E%5D%3E%3Cx%3E%26a%3B%3C%2Fx%3E' data-rule='SSRF 内网/云元数据访问'><td class='muted'></td><td>GET</td><td>http://shop.example.com:80/api/xml?data=%3C%3Fxml+version%3D%221.0%22%3F%3E%3C%21DOCTYPE+x+%5B%3C%21ENTITY+a+SYSTEM+%22http%3A%2F%2F169.254.169.254%2Flatest%2Fmeta-data%2F%22%3E%5D%3E%3Cx%3E%26a%3B%3C%2Fx%3E</td><td>-</td><td>SSRF 内网/云元数据访问</td><td class='muted'>waf,forward</td></tr><tr class='evt-row' data-ip='185.105.149.16' data-ua='waf,forward' data-path='http://shop.example.com:80/api/xml?data=%3C%3Fxml+version%3D%221.0%22%3F%3E%3C%21DOCTYPE+x+%5B%3C%21ENTITY+a+SYSTEM+%22http%3A%2F%2F169.254.169.254%2Flatest%2Fmeta-data%2F%22%3E%5D%3E%3Cx%3E%26a%3B%3C%2Fx%3E' data-rule='SSRF 内网/云元数据访问'><td colspan='6' class='muted'><code>http 2025-08-26T03:00:18.870000Z app/my-alb/50dc6c495c0c9188 185.105.149.16:33328 10.114.155.76:80 0.004483 0.413941 0.004050 400 400 1692 579 &quot;GET http://shop.example.com:80/api/xml?data=%3C%3Fxml+version%3D%221.0%22%3F%3E%3C%21DOCTYPE+x+%5B%3C%21ENTITY+a+SYSTEM+%22http%3A%2F%2F169.254.169.254%2Flatest%2Fmeta-data%2F%22%3E%5D%3E%3Cx%3E%26a%3B%3C%2Fx%3E HTTP/1.1&quot; &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 13_6) AppleWebKit/605.1.15 Version/17.4 Safari/605.1.15&quot; - - arn:aws:elasticloadbalancing:us-west-2:123456789012:targetgroup/my-tg/73e2d6bc24d8a067 &quot;Root=1-8fccb666-74daafd1f1090532cf1b16e6&quot; shop.example.com - 3 2025-08-26T03:00:18.870000Z &quot;waf,forward&quot; - - - - - -
</code></td></tr></tbody></table></details></section><p class='muted'>Generated by checkMultiLog</p></main></body></html>