<!doctype html><html><head><meta charset='utf-8'><title>checkMultiLog日志安全分析报告</title><style>
:root{--bg:#fff;--fg:#222;--muted:#666;--card:#f6f8fa;--line:#e6e6e6;--hit:#fff8e1;}
html[data-theme=dark]{--bg:#111;--fg:#eee;--muted:#aaa;--card:#1b1b1b;--line:#333;--hit:#222814;}
body{font-family:Segoe UI,Arial; margin:0; background:var(--bg); color:var(--fg);}
header{position:sticky; top:0; background:var(--card); border-bottom:1px solid var(--line); padding:10px 16px; z-index:10;}
main{padding:16px;}
h1{font-size:18px; margin:0 0 6px 0;}
.meta{font-size:12px; color:var(--muted);} .bar{display:flex; gap:12px; align-items:center; flex-wrap:wrap; margin-top:8px;}
input[type=text]{padding:6px 10px; width:360px; background:var(--bg); color:var(--fg); border:1px solid var(--line);}
button{padding:6px 10px; border:1px solid var(--line); background:var(--bg); color:var(--fg); cursor:pointer;}
section{margin-top:18px;} table{border-collapse:collapse; width:100%;}
th,td{border:1px solid var(--line); padding:6px 8px; font-size:13px; vertical-align:top;} th{background:#f5f5f5; text-align:left;}
details{border:1px solid var(--line); margin:8px 0; background:var(--card);} details>summary{padding:8px; cursor:pointer; font-weight:600; background:#f5f5f5;}
.evt-row{background:var(--hit);} code{font-size:11px;} .muted{color:var(--muted);} a{color:inherit; text-decoration:underline;}
.iplink{cursor:pointer; color:#2a7ae2; text-decoration:underline;} .pill{display:inline-block; padding:2px 8px; border:1px solid var(--line); border-radius:10px; margin:0 6px 0 0; font-size:12px;}
.wh-box{display:flex; gap:8px; flex-wrap:wrap; align-items:center;}
</style><script>
const whitelist = {ips:new Set(), ua:[], path:[], rule:[]};
function filterRows(){
  const q=document.getElementById('q').value.toLowerCase();
  const rows=[...document.querySelectorAll('.evt-row')];
  rows.forEach(tr=>{
    const txt=tr.innerText.toLowerCase();
    const ip=tr.dataset.ip || ''; const ua=tr.dataset.ua || ''; const path=tr.dataset.path || ''; const rule=tr.dataset.rule || '';
    let ok = (!q || txt.includes(q));
    if(ok){
      if(whitelist.ips.size && whitelist.ips.has(ip)) ok=false;
      if(ok && whitelist.ua.length){ ok = !whitelist.ua.some(p=>new RegExp(p,'i').test(ua)); }
      if(ok && whitelist.path.length){ ok = !whitelist.path.some(p=>new RegExp(p,'i').test(path)); }
      if(ok && whitelist.rule.length){ ok = !whitelist.rule.some(p=>new RegExp(p,'i').test(rule)); }
    }
    tr.style.display = ok ? '' : 'none';
  });
  const ipCount=new Map(), ruleCount=new Map();
  document.querySelectorAll('.evt-row[data-ip]').forEach(tr=>{
    if(tr.style.display==='none') return;
    const ip=tr.dataset.ip, rule=tr.dataset.rule;
    ipCount.set(ip, (ipCount.get(ip)||0)+1);
    ruleCount.set(rule, (ruleCount.get(rule)||0)+1);
  });
  const ipBody=document.getElementById('top_ips_body'); if(ipBody){ ipBody.innerHTML=''; let i=1; [...ipCount.entries()].sort((a,b)=>b[1]-a[1]).slice(0,80).forEach(([ip,cnt])=>{
    const safe=ip.replace(/[^a-zA-Z0-9_.-]/g,'_'); const tr=document.createElement('tr'); tr.innerHTML=`<td>${i++}</td><td><a class="iplink" onclick="openIp('${safe}')">${ip}</a></td><td>${cnt}</td>`; ipBody.appendChild(tr);
  });}
  const ruleBody=document.getElementById('top_rules_body'); if(ruleBody){ ruleBody.innerHTML=''; let i=1; [...ruleCount.entries()].sort((a,b)=>b[1]-a[1]).slice(0,80).forEach(([rule,cnt])=>{
    const tr=document.createElement('tr'); tr.innerHTML=`<td>${i++}</td><td>${rule}</td><td>${cnt}</td>`; ruleBody.appendChild(tr);
  });}
}
function initTheme(){ const t=localStorage.getItem('theme')||'light'; document.documentElement.setAttribute('data-theme', t); }
function toggleTheme(){ const cur=document.documentElement.getAttribute('data-theme'); const nxt = cur==='dark'?'light':'dark'; localStorage.setItem('theme',nxt); document.documentElement.setAttribute('data-theme',nxt); }
function openIp(ip){
  const id='ip_'+ip.replace(/[^a-zA-Z0-9_.-]/g,'_'); const el=document.getElementById(id);
  if(el){ el.setAttribute('open','open'); el.scrollIntoView({behavior:'smooth', block:'start'}); }
}
function addWhitelist(type){
  const el = document.getElementById('wh_'+type); const val = (el.value||'').trim(); if(!val) return;
  if(type==='ip'){ whitelist.ips.add(val); addPill(type,val); }
  else { whitelist[type].push(val); addPill(type,val); }
  el.value=''; filterRows();
}
function addPill(type, val){
  const box = document.getElementById('whlist_'+type);
  const span = document.createElement('span'); span.className='pill'; span.textContent=type+': '+val+' ✕';
  span.onclick=()=>{ if(type==='ip'){ whitelist.ips.delete(val);} else { const arr=whitelist[type]; const i=arr.indexOf(val); if(i>=0) arr.splice(i,1);} span.remove(); filterRows(); };
  box.appendChild(span);
}
window.addEventListener('DOMContentLoaded', ()=>{ initTheme(); filterRows(); });
</script></head><body><header><h1>checkMultiLog日志安全分析报告</h1><div class='meta'>Log: <b>D:/sectools/BlueTeamTools/checkMultiLog/checkmultilog日志分析-GUI_V2/simpleLog\iis.log</b> | Total: <b>18</b> | Hits: <b>13</b></div><div class='bar'><input id='q' type='text' placeholder='搜索 关键词' oninput='filterRows()'><button onclick='toggleTheme()'>Light/Dark</button><div class='wh-box'>IP白名单: <input id='wh_ip' type='text' placeholder='192.168.1.1'> <button onclick="addWhitelist('ip')">添加</button>UA白名单(正则): <input id='wh_ua' type='text' placeholder='curl|monitor'> <button onclick="addWhitelist('ua')">添加</button>路径白名单(正则): <input id='wh_path' type='text' placeholder='/health|/metrics'> <button onclick="addWhitelist('path')">添加</button>规则白名单(正则): <input id='wh_rule' type='text' placeholder='SafeScanner|Docker'> <button onclick="addWhitelist('rule')">添加</button></div><div class='wh-box'><div id='whlist_ip'></div><div id='whlist_ua'></div><div id='whlist_path'></div><div id='whlist_rule'></div></div></div></header><main><section><h2>Top Source IPs</h2><table><thead><tr><th>#</th><th>IP</th><th>Hits(过滤后)</th></tr></thead><tbody id='top_ips_body'><tr><td>1</td><td><a class='iplink' onclick="openIp('198.51.100.22')">198.51.100.22</a></td><td>2</td></tr><tr><td>2</td><td><a class='iplink' onclick="openIp('127.0.0.1')">127.0.0.1</a></td><td>1</td></tr><tr><td>3</td><td><a class='iplink' onclick="openIp('192.0.2.77')">192.0.2.77</a></td><td>1</td></tr><tr><td>4</td><td><a class='iplink' onclick="openIp('192.168.1.55')">192.168.1.55</a></td><td>1</td></tr><tr><td>5</td><td><a class='iplink' onclick="openIp('198.18.0.1')">198.18.0.1</a></td><td>1</td></tr><tr><td>6</td><td><a class='iplink' onclick="openIp('198.51.100.50')">198.51.100.50</a></td><td>1</td></tr><tr><td>7</td><td><a class='iplink' onclick="openIp('198.51.100.60')">198.51.100.60</a></td><td>1</td></tr><tr><td>8</td><td><a class='iplink' onclick="openIp('203.0.113.10')">203.0.113.10</a></td><td>1</td></tr><tr><td>9</td><td><a class='iplink' onclick="openIp('203.0.113.15')">203.0.113.15</a></td><td>1</td></tr><tr><td>10</td><td><a class='iplink' onclick="openIp('203.0.113.201')">203.0.113.201</a></td><td>1</td></tr><tr><td>11</td><td><a class='iplink' onclick="openIp('203.0.113.8')">203.0.113.8</a></td><td>1</td></tr><tr><td>12</td><td><a class='iplink' onclick="openIp('203.0.113.9')">203.0.113.9</a></td><td>1</td></tr></tbody></table></section><section><h2>Top Rules</h2><table><thead><tr><th>#</th><th>Rule</th><th>Hits(过滤后)</th></tr></thead><tbody id='top_rules_body'><tr><td>1</td><td>SQL注入(精简高准确)</td><td>2</td></tr><tr><td>2</td><td>可疑上传(双扩展/解析绕过)</td><td>2</td></tr><tr><td>3</td><td>Nuclei扫描器</td><td>1</td></tr><tr><td>4</td><td>Kubernetes 未授权API(弱告警)</td><td>1</td></tr><tr><td>5</td><td>SSRF 内网/云元数据访问</td><td>1</td></tr><tr><td>6</td><td>Neo-reGeorg 代理隧道</td><td>1</td></tr><tr><td>7</td><td>跨站脚本(XSS)(收敛)</td><td>1</td></tr><tr><td>8</td><td>ThinkPHP RCE 常见面</td><td>1</td></tr><tr><td>9</td><td>WPScan扫描器</td><td>1</td></tr><tr><td>10</td><td>路径遍历/敏感文件</td><td>1</td></tr><tr><td>11</td><td>fscan扫描器</td><td>1</td></tr></tbody></table></section><section><h2>Events by IP</h2><details id='ip_127.0.0.1'><summary>127.0.0.1 <span class='muted'>(1 hits)</span></summary><table><thead><tr><th>Time</th><th>Method</th><th>Path</th><th>Status</th><th>Rule</th><th>User-Agent</th></tr></thead><tbody><tr class='evt-row' data-ip='127.0.0.1' data-ua='curl/7.79.1' data-path='' data-rule='SSRF 内网/云元数据访问'><td class='muted'>2025-08-26 09:25:25</td><td>curl/7.79.1</td><td></td><td>456</td><td>SSRF 内网/云元数据访问</td><td class='muted'>curl/7.79.1</td></tr><tr class='evt-row' data-ip='127.0.0.1' data-ua='curl/7.79.1' data-path='' data-rule='SSRF 内网/云元数据访问'><td colspan='6' class='muted'><code>2025-08-26 09:25:25 GET /api/data?url=http://127.0.0.1:8080/server-status 198.18.0.2 &quot;curl/7.79.1&quot; 200 456
</code></td></tr></tbody></table></details><details id='ip_192.0.2.77'><summary>192.0.2.77 <span class='muted'>(1 hits)</span></summary><table><thead><tr><th>Time</th><th>Method</th><th>Path</th><th>Status</th><th>Rule</th><th>User-Agent</th></tr></thead><tbody><tr class='evt-row' data-ip='192.0.2.77' data-ua='Go-http-client/1.1' data-path='' data-rule='Kubernetes 未授权API(弱告警)'><td class='muted'>2025-08-26 09:21:44</td><td>Go-http-client/1.1</td><td></td><td>5000</td><td>Kubernetes 未授权API(弱告警)</td><td class='muted'>Go-http-client/1.1</td></tr><tr class='evt-row' data-ip='192.0.2.77' data-ua='Go-http-client/1.1' data-path='' data-rule='Kubernetes 未授权API(弱告警)'><td colspan='6' class='muted'><code>2025-08-26 09:21:44 GET /api/v1/pods - 192.0.2.77 &quot;Go-http-client/1.1&quot; 200 5000
</code></td></tr></tbody></table></details><details id='ip_192.168.1.55'><summary>192.168.1.55 <span class='muted'>(1 hits)</span></summary><table><thead><tr><th>Time</th><th>Method</th><th>Path</th><th>Status</th><th>Rule</th><th>User-Agent</th></tr></thead><tbody><tr class='evt-row' data-ip='192.168.1.55' data-ua='Xray-Scanner/1.9' data-path='' data-rule='路径遍历/敏感文件'><td class='muted'>2025-08-26 09:20:11</td><td>Xray-Scanner/1.9</td><td></td><td>1443</td><td>路径遍历/敏感文件</td><td class='muted'>Xray-Scanner/1.9</td></tr><tr class='evt-row' data-ip='192.168.1.55' data-ua='Xray-Scanner/1.9' data-path='' data-rule='路径遍历/敏感文件'><td colspan='6' class='muted'><code>2025-08-26 09:20:11 GET /s/..%2f..%2f..%2fetc/passwd - 192.168.1.55 &quot;Xray-Scanner/1.9&quot; 500 1443
</code></td></tr></tbody></table></details><details id='ip_198.18.0.1'><summary>198.18.0.1 <span class='muted'>(1 hits)</span></summary><table><thead><tr><th>Time</th><th>Method</th><th>Path</th><th>Status</th><th>Rule</th><th>User-Agent</th></tr></thead><tbody><tr class='evt-row' data-ip='198.18.0.1' data-ua='Mozilla/5.0 (Windows NT 10.0)' data-path='(Windows' data-rule='Neo-reGeorg 代理隧道'><td class='muted'>2025-08-26 09:18:11</td><td>Mozilla/5.0</td><td>(Windows</td><td>512</td><td>Neo-reGeorg 代理隧道</td><td class='muted'>Mozilla/5.0 (Windows NT 10.0)</td></tr><tr class='evt-row' data-ip='198.18.0.1' data-ua='Mozilla/5.0 (Windows NT 10.0)' data-path='(Windows' data-rule='Neo-reGeorg 代理隧道'><td colspan='6' class='muted'><code>2025-08-26 09:18:11 GET /tunnel.jsp HTTP/1.1 198.18.0.1 &quot;Mozilla/5.0 (Windows NT 10.0)&quot; 200 512
</code></td></tr></tbody></table></details><details id='ip_198.51.100.22'><summary>198.51.100.22 <span class='muted'>(2 hits)</span></summary><table><thead><tr><th>Time</th><th>Method</th><th>Path</th><th>Status</th><th>Rule</th><th>User-Agent</th></tr></thead><tbody><tr class='evt-row' data-ip='198.51.100.22' data-ua='WPScan/21.1' data-path='' data-rule='WPScan扫描器'><td class='muted'>2025-08-26 09:15:47</td><td>WPScan/21.1</td><td></td><td>1337</td><td>WPScan扫描器</td><td class='muted'>WPScan/21.1</td></tr><tr class='evt-row' data-ip='198.51.100.22' data-ua='WPScan/21.1' data-path='' data-rule='WPScan扫描器'><td colspan='6' class='muted'><code>2025-08-26 09:15:47 GET /wp-admin/admin-ajax.php action=test 198.51.100.22 &quot;WPScan/21.1&quot; 200 1337
</code></td></tr><tr class='evt-row' data-ip='198.51.100.22' data-ua='curl/7.83.1' data-path='' data-rule='ThinkPHP RCE 常见面'><td class='muted'>0</td><td>curl/7.83.1</td><td></td><td>2987</td><td>ThinkPHP RCE 常见面</td><td class='muted'>curl/7.83.1</td></tr><tr class='evt-row' data-ip='198.51.100.22' data-ua='curl/7.83.1' data-path='' data-rule='ThinkPHP RCE 常见面'><td colspan='6' class='muted'><code>2025-08-26 09:16:13 GET /index.php?s=/Index/\think\app/invokefunction&amp;function=phpinfo&amp;vars[0]=1 198.51.100.22 &quot;curl/7.83.1&quot; 200 2987
</code></td></tr></tbody></table></details><details id='ip_198.51.100.50'><summary>198.51.100.50 <span class='muted'>(1 hits)</span></summary><table><thead><tr><th>Time</th><th>Method</th><th>Path</th><th>Status</th><th>Rule</th><th>User-Agent</th></tr></thead><tbody><tr class='evt-row' data-ip='198.51.100.50' data-ua='Mozilla/5.0' data-path='' data-rule='可疑上传(双扩展/解析绕过)'><td class='muted'>2025-08-26 09:17:42</td><td>Mozilla/5.0</td><td></td><td>10240</td><td>可疑上传(双扩展/解析绕过)</td><td class='muted'>Mozilla/5.0</td></tr><tr class='evt-row' data-ip='198.51.100.50' data-ua='Mozilla/5.0' data-path='' data-rule='可疑上传(双扩展/解析绕过)'><td colspan='6' class='muted'><code>2025-08-26 09:17:42 GET /shell.jsp?cmd=whoami 198.51.100.50 &quot;Mozilla/5.0&quot; 200 10240
</code></td></tr></tbody></table></details><details id='ip_198.51.100.60'><summary>198.51.100.60 <span class='muted'>(1 hits)</span></summary><table><thead><tr><th>Time</th><th>Method</th><th>Path</th><th>Status</th><th>Rule</th><th>User-Agent</th></tr></thead><tbody><tr class='evt-row' data-ip='198.51.100.60' data-ua='Mozilla/5.0' data-path='' data-rule='可疑上传(双扩展/解析绕过)'><td class='muted'>2025-08-26 09:24:00</td><td>Mozilla/5.0</td><td></td><td>123</td><td>可疑上传(双扩展/解析绕过)</td><td class='muted'>Mozilla/5.0</td></tr><tr class='evt-row' data-ip='198.51.100.60' data-ua='Mozilla/5.0' data-path='' data-rule='可疑上传(双扩展/解析绕过)'><td colspan='6' class='muted'><code>2025-08-26 09:24:00 POST /upload.php filename=shell.php%00.jpg 198.51.100.60 &quot;Mozilla/5.0&quot; 200 123
</code></td></tr></tbody></table></details><details id='ip_203.0.113.10'><summary>203.0.113.10 <span class='muted'>(1 hits)</span></summary><table><thead><tr><th>Time</th><th>Method</th><th>Path</th><th>Status</th><th>Rule</th><th>User-Agent</th></tr></thead><tbody><tr class='evt-row' data-ip='203.0.113.10' data-ua='fscan/1.8' data-path='' data-rule='fscan扫描器'><td class='muted'>2025-08-26 09:18:55</td><td>fscan/1.8</td><td></td><td>210</td><td>fscan扫描器</td><td class='muted'>fscan/1.8</td></tr><tr class='evt-row' data-ip='203.0.113.10' data-ua='fscan/1.8' data-path='' data-rule='fscan扫描器'><td colspan='6' class='muted'><code>2025-08-26 09:18:55 POST /api/auth user=admin&amp;pwd=admin 203.0.113.10 &quot;fscan/1.8&quot; 403 210
</code></td></tr></tbody></table></details><details id='ip_203.0.113.15'><summary>203.0.113.15 <span class='muted'>(1 hits)</span></summary><table><thead><tr><th>Time</th><th>Method</th><th>Path</th><th>Status</th><th>Rule</th><th>User-Agent</th></tr></thead><tbody><tr class='evt-row' data-ip='203.0.113.15' data-ua='Mozilla/5.0 Chrome/118.0' data-path='Chrome/118.0' data-rule='跨站脚本(XSS)(收敛)'><td class='muted'>2025-08-26 09:19:30</td><td>Mozilla/5.0</td><td>Chrome/118.0</td><td>1890</td><td>跨站脚本(XSS)(收敛)</td><td class='muted'>Mozilla/5.0 Chrome/118.0</td></tr><tr class='evt-row' data-ip='203.0.113.15' data-ua='Mozilla/5.0 Chrome/118.0' data-path='Chrome/118.0' data-rule='跨站脚本(XSS)(收敛)'><td colspan='6' class='muted'><code>2025-08-26 09:19:30 GET /search?q=&lt;script&gt;alert(1)&lt;/script&gt; 203.0.113.15 &quot;Mozilla/5.0 Chrome/118.0&quot; 200 1890
</code></td></tr></tbody></table></details><details id='ip_203.0.113.201'><summary>203.0.113.201 <span class='muted'>(1 hits)</span></summary><table><thead><tr><th>Time</th><th>Method</th><th>Path</th><th>Status</th><th>Rule</th><th>User-Agent</th></tr></thead><tbody><tr class='evt-row' data-ip='203.0.113.201' data-ua='Nuclei - Template v2.9' data-path='-' data-rule='Nuclei扫描器'><td class='muted'>2025-08-26 09:23:12</td><td>Nuclei</td><td>-</td><td>512</td><td>Nuclei扫描器</td><td class='muted'>Nuclei - Template v2.9</td></tr><tr class='evt-row' data-ip='203.0.113.201' data-ua='Nuclei - Template v2.9' data-path='-' data-rule='Nuclei扫描器'><td colspan='6' class='muted'><code>2025-08-26 09:23:12 GET /css/style.css - 203.0.113.201 &quot;Nuclei - Template v2.9&quot; 404 512
</code></td></tr></tbody></table></details><details id='ip_203.0.113.8'><summary>203.0.113.8 <span class='muted'>(1 hits)</span></summary><table><thead><tr><th>Time</th><th>Method</th><th>Path</th><th>Status</th><th>Rule</th><th>User-Agent</th></tr></thead><tbody><tr class='evt-row' data-ip='203.0.113.8' data-ua='sqlmap/1.5.2#user-agent' data-path='' data-rule='SQL注入(精简高准确)'><td class='muted'>2025-08-26 09:14:01</td><td>sqlmap/1.5.2#user-agent</td><td></td><td>872</td><td>SQL注入(精简高准确)</td><td class='muted'>sqlmap/1.5.2#user-agent</td></tr><tr class='evt-row' data-ip='203.0.113.8' data-ua='sqlmap/1.5.2#user-agent' data-path='' data-rule='SQL注入(精简高准确)'><td colspan='6' class='muted'><code>2025-08-26 09:14:01 GET /news.php?id=1%20or%201=1 203.0.113.8 &quot;sqlmap/1.5.2#user-agent&quot; 500 872
</code></td></tr></tbody></table></details><details id='ip_203.0.113.9'><summary>203.0.113.9 <span class='muted'>(1 hits)</span></summary><table><thead><tr><th>Time</th><th>Method</th><th>Path</th><th>Status</th><th>Rule</th><th>User-Agent</th></tr></thead><tbody><tr class='evt-row' data-ip='203.0.113.9' data-ua='python-requests/2.28.1' data-path='' data-rule='SQL注入(精简高准确)'><td class='muted'>2025-08-26 09:17:05</td><td>python-requests/2.28.1</td><td></td><td>921</td><td>SQL注入(精简高准确)</td><td class='muted'>python-requests/2.28.1</td></tr><tr class='evt-row' data-ip='203.0.113.9' data-ua='python-requests/2.28.1' data-path='' data-rule='SQL注入(精简高准确)'><td colspan='6' class='muted'><code>2025-08-26 09:17:05 GET /?id=1%20union%20select%20user,password%20from%20mysql.user 203.0.113.9 &quot;python-requests/2.28.1&quot; 500 921
</code></td></tr></tbody></table></details></section><p class='muted'>Generated by checkMultiLog</p></main></body></html>